<html>
<body>
  <h1>タイマー</h1>
  <form action="" id="form">
    <input type="text" name="min">分
    <input type="submit" value="セット">
  </form>
  <div id="timer">
    <span id="min"></span>分
    <span id="sec"></span>秒
    
  </div>
  <script>
    'use strict';
   /*
      setTimeout(disp, 1000, goal) と
      disp()に引数を渡す
   */
    
    let counter;
    // let goal;
    
    const $form = document.getElementById('form');
    $form.onsubmit = function(e) {
    	e.preventDefault();
    	const min = parseInt($form.min.value);
    	let goal = new Date();
    	goal.setMinutes(goal.getMinutes() + min);
    	disp(goal);
    }
    
    function countdown(due) {
	    const now = new Date();
	    const rest = due.getTime() - now.getTime();
	    // 90064692854 (rest)
	    const sec = Math.floor(rest/1000) % 60;         // 53
	    const min = Math.floor(rest/1000/60) % 60;      // 54
	    const hours = Math.floor(rest/1000/60/60) % 24;  // 9
	    const days = Math.floor(rest/1000/60/60/24);  // 1042
	    const count = [days, hours, min, sec];
	    // console.log(count);  // Array(4) [ 1042, 9, 49, 56 ]
			return count;    
    }
    
    function disp(goal) {
    	counter = countdown(goal);
			const $min = document.getElementById('min');
			$min.textContent = counter[2];
			const $sec = document.getElementById('sec');
			$sec.textContent = counter[3];
    	refresh(goal);
    }
    
    function refresh(goal) {
    	setTimeout(disp, 1000, goal);
    }

  </script>
</body>
</html>

<!-- 修正時刻: Fri 2025/09/05 19:59:19 -->
